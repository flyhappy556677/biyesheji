{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Vue from 'vue';\nimport VueRouter from 'vue-router';\nimport HomeView from '../views/Manage.vue';\nimport store from \"@/store\";\nVue.use(VueRouter);\nconst routes = [{\n  path: '/login',\n  name: 'login',\n  component: () => import( /* webpackChunkName: \"about\" */'../views/Login.vue')\n}, {\n  path: '/register',\n  name: 'Register',\n  component: () => import( /* webpackChunkName: \"about\" */'../views/Register.vue')\n}, {\n  path: '/404',\n  name: '404',\n  component: () => import( /* webpackChunkName: \"about\" */'../views/404.vue')\n}];\nconst router = new VueRouter({\n  mode: 'history',\n  base: process.env.BASE_URL,\n  routes\n});\n//刷新页面会重置路由\nexport const setRoutes = () => {\n  const storeMenus = localStorage.getItem(\"menus\");\n  if (storeMenus) {\n    const manageRoute = {\n      path: '',\n      name: 'Manage',\n      component: () => import('../views/Manage.vue'),\n      redirect: \"/home\",\n      children: []\n    };\n    const menus = JSON.parse(storeMenus);\n    menus.forEach(item => {\n      if (item.path) {\n        //当且仅当path不为空的时候才去设置路由\n        let itemMenu = {\n          path: item.path.replace(\"/\", \"\"),\n          name: item.name,\n          component: () => import('../views/' + item.pagePath + '.vue')\n        };\n        manageRoute.children.push(itemMenu);\n      } else if (item.children.length) {\n        item.children.forEach(item => {\n          if (item.path) {\n            let itemMenu = {\n              path: item.path.replace(\"/\", \"\"),\n              name: item.name,\n              component: () => import('../views/' + item.pagePath + '.vue')\n            };\n            manageRoute.children.push(itemMenu);\n          }\n        });\n      }\n    });\n    //获取当前的路由对象名称数组\n    const currentRouteNames = router.getRoutes().map(v => v.name);\n    if (!currentRouteNames.includes('Manage')) {\n      //动态添加到现在的路由对象中\n      router.addRoute(manageRoute);\n    }\n  }\n};\n//动态添加到现在的路由对象中\nsetRoutes();\nrouter.beforeEach((to, from, next) => {\n  localStorage.setItem(\"currentPathName\", to.name); //设置当前路由名称,为了在Header组件使用\n  store.commit(\"setPath\"); //触发store的数据更新\n\n  const storeMenus = localStorage.getItem(\"menus\");\n  if (storeMenus) {\n    next(); //放行路由\n  } else {\n    next(\"/login\");\n  }\n});\nexport default router;","map":{"version":3,"names":["Vue","VueRouter","HomeView","store","use","routes","path","name","component","router","mode","base","process","env","BASE_URL","setRoutes","storeMenus","localStorage","getItem","manageRoute","redirect","children","menus","JSON","parse","forEach","item","itemMenu","replace","pagePath","push","length","currentRouteNames","getRoutes","map","v","includes","addRoute","beforeEach","to","from","next","setItem","commit"],"sources":["D:/Code/biyesheji/drone-manager/src/router/index.js"],"sourcesContent":["import Vue from 'vue'\nimport VueRouter from 'vue-router'\nimport HomeView from '../views/Manage.vue'\nimport store from \"@/store\";\n\nVue.use(VueRouter)\n\nconst routes = [\n\n  {\n    path: '/login',\n    name: 'login',\n    component: () => import(/* webpackChunkName: \"about\" */ '../views/Login.vue')\n    },\n    {\n      path: '/register',\n      name: 'Register',\n      component: () => import(/* webpackChunkName: \"about\" */ '../views/Register.vue')\n    },\n    {\n      path: '/404',\n      name: '404',\n      component: () => import(/* webpackChunkName: \"about\" */ '../views/404.vue')\n    }\n]\n\nconst router = new VueRouter({\n  mode: 'history',\n  base: process.env.BASE_URL,\n  routes\n})\n//刷新页面会重置路由\nexport  const setRoutes=() =>{\n  const storeMenus=localStorage.getItem(\"menus\");\n  if(storeMenus){\n    const manageRoute={path: '',name:'Manage', component: () => import( '../views/Manage.vue'), redirect:\"/home\",children:[]}\n    const menus=JSON.parse(storeMenus)\n    menus.forEach(item =>{\n      if(item.path){//当且仅当path不为空的时候才去设置路由\n        let itemMenu={path: item.path.replace(\"/\",\"\"),name:item.name,component:() => import('../views/'+item.pagePath +'.vue')}\n        manageRoute.children.push(itemMenu)\n      }else if (item.children.length){\n        item.children.forEach(item =>{\n          if(item.path){\n            let itemMenu={path: item.path.replace(\"/\",\"\"),name:item.name,component:() => import('../views/'+item.pagePath +'.vue')}\n            manageRoute.children.push(itemMenu)}\n        })\n      }\n\n    })\n    //获取当前的路由对象名称数组\n    const currentRouteNames =router.getRoutes().map(v =>v.name)\n    if(!currentRouteNames.includes('Manage')){\n      //动态添加到现在的路由对象中\n      router.addRoute(manageRoute)\n    }\n  }\n}\n//动态添加到现在的路由对象中\nsetRoutes()\n\nrouter.beforeEach((to, from, next) =>{\n  localStorage.setItem(\"currentPathName\",to.name) //设置当前路由名称,为了在Header组件使用\n  store.commit(\"setPath\") //触发store的数据更新\n\n  const storeMenus=localStorage.getItem(\"menus\")\n  if(storeMenus){\n    next() //放行路由\n  }else {\n    next(\"/login\")\n  }\n\n})\n\nexport default router\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}